This folder contains all the input files, python and r scripts necessary to run the MrpC ChIP-seq bioinformatic analysis. It also contains all output files generated. 

To run the master analysis script you will need python and r installed on a mac or linux/unix computer. The command to run the analysis is:
python analysePeaks.py MrpC-1_peak_caller.ChIP.out.accepted MrpC-2_peak_caller.ChIP.out.accepted final NC_008095.ptt HiggsAnnotations.txt 


analysePeaks.py  - master analysis python script
MrpC-1_peak_caller.ChIP.out.accepted - ChIP-seq calls from experimental replicate 1
MrpC-2_peak_caller.ChIP.out.accepted - ChIP-seq calls from experimental replicate 2
final - root name for all output files (can vary this for other runs)
NC_008095.ptt - NCBI gene annotations for myxo genome
HiggsAnnotations - File containing COG annotations generated by Huntley and Higgs in (Huntley et al, 2011)


A crude step by step breakdown of the algorithm and files output follows

General summary information about the analysis is written to file: final-summary.txt

The script reads in and parses the input files. 
It then compares the two replicates and pairs peaks with their closest peak in the other replicate
A file is output containing the distances between these paired peaks: final-unfilteredPeakDistances-noAnnot.txt
Next these pairs of peaks are filtered to include only those within 65bp.
A file is output containing the distances between thes filtered paired peaks: final-peakDistances.noAnnot.txt
A file is output containing details of the peaks for each pair used in the analysis: final-pairs.txt
Each peak is then examined to see if it falls within 400bp downstream, or 100bp upsteam of the start of an ORF. Any peaks that do not are filtered out. 
The number of peaks that are found in proximity to two genes is used to estimate the number of divergent promoters associated with a peak
A set of artifical peaks of equal size are placed randomly in the genome using a monte carlo simulation to provide a computatational control dataset. These peaks are annotated with nearby ORFs in the same way.
A file is output showing the distances from each ChIP-seq peak to nearby ORFS
A file is output showing the distances from each randomized peak to nearby ORFS
An R script is run which uses the output files to generate a range of plots:
   a) the cumulative distribution of the distances between closest peaks across the replicates
      (peaksUnfiltCumul.png)
   b) the frequency distribution of the distances between all retained replicate peak pairs
      (peaksHistNoAnnot.png)
   c) the frequency distribution of the distance from each ChIP-seq peak to the nearest ORF
      (peaksHist.png)
   d) the frequency distribution of the distance from each randomized peak to the nearest ORF
      (randPeaksHist.png)
The proportion of ChIP-seq peaks falling in intergenic regions compared to coding regions is enumerated and output to a file: final-intergenicDistribution-summary.txt
The proportion of randomized peaks falling in intergenic regions compared to coding regions is enumerated and output to a file: final-randomIntergenicDistribution-summary.txt
The number of peaks annotated with a particular COG category are enumerated and output to a file: final-cog.txt
Finally, a summary of the final set of peaks along with the annotations of any ORFs they are associated with are writen to another file: final-peaks.csv
